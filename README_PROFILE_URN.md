# LinkedIn Profile URN Extractor

This tool extracts the profile URN (hostRecipientUrns) from a LinkedIn profile URL, which is essential for sending messages to new contacts via the LinkedIn API.

## Background

LinkedIn's messaging API requires:
- Your own URN (`mailboxUrn`)
- The recipient's URN (`hostRecipientUrns`)

For contacts you've never messaged before, you need to extract their URN directly from their profile page before you can message them.

## Usage

```
python get_profile_urns.py <linkedin_profile_url>
```

For example:
```
python get_profile_urns.py https://www.linkedin.com/in/johndoe/
```

## Example Output

The script will:
1. Extract the profile URN
2. Format ready-to-use JSON for API requests
3. Provide a PowerShell-compatible version

```
================================================================================
‚úÖ LINKEDIN PROFILE URN EXTRACTION SUCCESSFUL
================================================================================
üîπ Your URN (mailbox_urn): urn:li:fsd_profile:ACoAACP6v4EBbrCCbpgNB017RQfDpIJA4cgt_oc
üîπ Recipient URN (hostRecipientUrns): urn:li:fsd_profile:ACoAADEwkRUBRsclphM3WfnP

================================================================================
üìù READY-TO-USE JSON FOR API REQUEST
================================================================================
{
  "message": {
    "body": {
      "attributes": [],
      "text": "YOUR_MESSAGE_HERE"
    },
    "originToken": "94b330ff-6b5f-4d34-baeb-90f8e153c423",
    "renderContentUnions": []
  },
  "mailboxUrn": "urn:li:fsd_profile:ACoAACP6v4EBbrCCbpgNB017RQfDpIJA4cgt_oc",
  "trackingId": "fae193ef-7650-42",
  "dedupeByClientGeneratedToken": false,
  "hostRecipientUrns": [
    "urn:li:fsd_profile:ACoAADEwkRUBRsclphM3WfnP"
  ]
}
```

## Using with PowerShell

To send a message using PowerShell:

1. Run the script to extract the recipient's URN
2. Use the PowerShell JSON output in your API call:

```powershell
$session = New-Object Microsoft.PowerShell.Commands.WebRequestSession
$session.UserAgent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"

# Add your cookies here
$session.Cookies.Add((New-Object System.Net.Cookie("bcookie", "...", "/", ".linkedin.com")))
# ... more cookies ...

# The body content generated by the script (replace YOUR_MESSAGE_HERE with your message)
$body = {... JSON from script output ...}

Invoke-WebRequest -UseBasicParsing -Uri "https://www.linkedin.com/voyager/api/voyagerMessagingDashMessengerMessages?action=createMessage" `
-Method "POST" `
-WebSession $session `
-Headers @{
  "authority"="www.linkedin.com"
  "method"="POST"
  # ... more headers ...
} `
-ContentType "text/plain;charset=UTF-8" `
-Body ([System.Text.Encoding]::UTF8.GetBytes($body))
```

## How It Works

This script:
1. Uses your LinkedIn cookies for authentication
2. Visits the target profile page
3. Extracts the profile URN (unique identifier) with pattern matching
4. Creates a properly formatted message payload
5. Outputs everything you need for a successful API call

## Troubleshooting

If the script fails to extract a URN:
1. Make sure you're logged into LinkedIn (check cookies)
2. Verify the profile URL is correct and accessible
3. Try with a different profile URL

## Notes

- This script doesn't send messages directly; it only extracts the URNs
- LinkedIn's API requires you to be logged in
- Update the cookies in the script with your own LinkedIn cookies 